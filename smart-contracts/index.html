<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>Smart Contracts – Ramen-Ya</title> <meta name="description" content="Build Ramen with other players on the Ethereum Blockchain!"> <meta name="keywords" content="ramen, code, smart contract, solidity"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://ramenya.world/assets/img/logo.png"> <meta name="twitter:title" content="Smart Contracts"> <meta name="twitter:description" content="Here are some snippets from the smart contracts"> <meta name="twitter:site" content="@awasunyin"> <meta name="twitter:creator" content="@awasunyin"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Smart Contracts"> <meta property="og:description" content="Here are some snippets from the smart contracts"> <meta property="og:url" content="http://ramenya.world/smart-contracts/"> <meta property="og:site_name" content="Ramen-Ya"> <meta property="og:image" content="http://ramenya.world/assets/img/logo.png"> <link rel="canonical" href="http://ramenya.world/smart-contracts/"> <link href="http://ramenya.world/feed.xml" type="application/atom+xml" rel="alternate" title="Ramen-Ya Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="http://ramenya.world/assets/css/main.css"> <!-- JS --> <script src="http://ramenya.world/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="http://ramenya.world/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="http://ramenya.world/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://ramenya.world/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://ramenya.world/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="http://ramenya.world/favicon.png"> <link rel="shortcut icon" href="http://ramenya.world/favicon.ico"> <!-- Background Image --> <style type="text/css">body {background-image:url(http://ramenya.world/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://ramenya.world/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://ramenya.world/assets/img/logo.png" alt="Ramen-Ya photo" class="author-photo"> <h4>Ramen-Ya</h4> <p>Build Ramen with other players on the Ethereum Blockchain!</p> </li> <li><a href="http://ramenya.world/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="http://twitter.com/awasunyin" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> </li> <li> <a href="http://github.com/awasunyin/ramen-for-ethdenver" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul>
<!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="http://ramenya.world/posts/">All Posts</a></li> <li><a href="http://ramenya.world/tags/">All Tags</a></li> </ul> </li> <li><a href="http://ramenya.world/projects/">Projects</a></li> </ul>
<!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>Smart Contracts</h1> <h4>18 Feb 2018</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~4 minutes </p>
<!-- /.entry-reading-time --> <a class="btn zoombtn" href="http://ramenya.world/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <h2 id="ramenya-in-depth">RamenYa in Depth</h2> <p>Here are explained some particularities of this game’s system.</p> <h3 id="ingredients">Ingredients</h3> <p>Initia ingredients in RamenYa come to existance when farmers from around to world havest them. This event depends on many factors, such as time, season, because it would not be sustainable otherwise and we would force farmers to opt unsustainable methods that would harm the planed unnecessarily.</p> <h4 id="ingredient-characteristics">Ingredient characteristics</h4> <div class="highlighter-rouge"><pre class="highlight"><code>struct Ingredient {
        // unique stock keeping unit
        uint256 ingredientSKU;
        // noodles, broth, or topping
        uint16 ingredientType;
        uint16 ingredientFlavorDepth;
        uint16 ingredientSeason;
        bool ingredientUsed;
    }
</code></pre></div> <p>The characteristics are determined in combination of a pseudrandomly generated 2-digits number and some hard coded ranges that determine the likelihood of each characteristic appearing. For example, if number is truly random, there’s 69% of chance that it will have level 1 in Flavour Depth and 1% of likelihood for level 4.</p> <div class="highlighter-rouge"><pre class="highlight"><code>    function _ingredientIsWhatFlavourDepth(uint _ingredientSKU) internal view returns(uint16) {
        uint16 ingredientFlavourDepth = uint16(_generateRandomCharacteristic(_ingredientSKU));
        
        // common flavour depth 
        if (ingredientFlavourDepth &lt;= 69) {
            return 1;
        }
        // semi rare flavour depth 
        if (ingredientFlavourDepth &lt;= 94) {
            return 2;
        } 
        // rare flavour depth
        if (ingredientFlavourDepth &lt;= 99) {
            return 3; 
        
        // mythical flavour depth
        } else {
            return 4;
        }
    }
</code></pre></div> <p>Ingredients cannot be directly transfered, they can only be combined to form Bowls (and only type noodles and broth can be combined at this stage). The properties of the ingredients used will influence in the final Ramen’s umami.</p> <h3 id="bowls">Bowls</h3> <p>Bowls are unique combinations of pairs of unique ingredients (where one must be noodles and the other one must be broth). Each bowl needs 30 minutes of preparation and they are transferrable. The only way of owning Bowls is either by combining ingredients yourself or by acquiring it at the Kitchen (where you can find all the bowls that are ready and check their properties).</p> <h4 id="bowls-characteristics">Bowls characteristics</h4> <div class="highlighter-rouge"><pre class="highlight"><code> struct Bowl {
        // noodles
        uint256 ingredient1SKU;
        // broth
        uint256 ingredient2SKU;
        // the id of the cooking session
        uint256 bowlId; 
        // remember to add a cooldown feature
        uint32 cookingReadyTime;
        // was this bowl already used
        bool isBowlUsed;
    }
</code></pre></div> <h3 id="ramen">Ramen</h3> <p>Ramen are the combination of a unique Bowl and a unique ingredient (of type topping). The main rule here is that the bowl must have been acquired from the kitchen: another player has prepared the bowl for you. Once acquired, you can choose what topping to add and enjoy Ramen in its true form.</p> <p>Note: for the sake of simplicity, Ramen in RamenYa are composed of 3 main ingredients (noodles, broth, topping), but in real life they should have <a href="http://www.pepper.ph/the-four-parts-of-a-ramen-bowl/">4 main components</a> and unlimited toppings (to be implemented).</p> <h4 id="characteristics-of-a-ramen">Characteristics of a Ramen</h4> <div class="highlighter-rouge"><pre class="highlight"><code>struct Ramen {
        uint256 ramenId;
        uint16 umamiLevel;
        bool wasDelivered;
        bool wasConsumed;
    }
</code></pre></div> <p>Where umami level is determined by the following function that considers the original ingredients characteristics and the current season (if an ingredient has season 1 (spring) and current date is within the spring dates, there’s a x2 bonus):</p> <div class="highlighter-rouge"><pre class="highlight"><code>function _calculateUmamiLevel(
        uint256 _bowlId, 
        uint256 _toppingSKU,
        uint16 _toppingFlavourDepth, 
        uint16 _toppingSeason,
        uint16 _noodlesFlavourDepth, 
        uint16 _noodlesSeason,
        uint16 _brothFlavourDepth,
        uint16 _brothSeason) 
        private view returns(uint16) 
        {
        uint randami = uint(keccak256(_bowlId, _toppingSKU)); 
        uint16 umami = uint16(randami % ingredientCharacteristicsModulus);
        uint16 bonusFromTopping = _calculateBonumami(_toppingFlavourDepth, _toppingSeason);
        uint16 bonusFromNoodles = _calculateBonumami(_noodlesFlavourDepth, _noodlesSeason);
        uint16 bonusFromBroth = _calculateBonumami(_brothFlavourDepth, _brothSeason);
        uint16 finami = umami + bonusFromTopping + bonusFromNoodles + bonusFromBroth;
        
        // TODO: Check the probabilities, but it should be exponentially
        // lower per unami level
        if (finami &lt;= 75) {
            return 1;
        }
        if (finami &lt;= 90) {
            return 2;
        }

        if (finami &lt;= 100) {
            return 3;
        }
        // legendary level
        if (finami &gt; 100) {
            return 4;
        }
    }
</code></pre></div> <p>Once Ramen has been formed, meaning that you bought a browl and added a topping, this unique ramen becomes transferrable. A buyer pays an amount of ETH or RamenCoin for your Ramen, which later on can be consumed. Once a ramen is consumed, there are two things that will happen: you’ll feel the warmth in your stomach and a new ingredient will spawn from it, which later on you can use to play again. This new ingredient’s properties will depend on the Ramen’s umamiLevel:</p> <div class="highlighter-rouge"><pre class="highlight"><code>    // you can only consume ramen that you bought
    function _itadakimasu(Ramen storage _ramenId) private onlyOwner {
        require(_ramenId.wasConsumed == false);
        extractIngredientsFromRamen(_ramenId);
    }

    function extractIngredientsFromRamen(Ramen storage _id) private {
        uint256 randSKU = uint256(keccak256(_id.ramenId));
        // change the generation of these are dependant on one variable only!
        // TODO: ingrediennt qualities will be influenced by 
        // the umami level of ramen
        uint16 randType = _ingredientIsWhatType(randSKU);
        uint16 randFlavourDepth = _ingredientIsWhatFlavourDepth(randSKU);
        uint16 randSeason = _ingredientIsWhatSeason(randSKU);
        uint256 id = ingredients.push(Ingredient(randSKU, randType, randFlavourDepth, randSeason, false)) - 1;
        // assign this new ingredient to owner
        ingredientToOwner[id] = msg.sender;
        ownerIngredientCount[msg.sender]++;
        IngredientForSale(id, randSKU);
    }
</code></pre></div> <p>As tribute to the producers of my learning content and (personal) continuous learning of smart contract development, there will be interfaces with existing ERC721 tokens. The idea is that, e.g., if ramen is delivered to Kitties, the Kitty will give you in return certain ingredients (freshly caught birds, fish, etc). And who knows, maybe if you feed the same kitty many times, the kitty wants to stay with you? (☆▽☆)</p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="http://ramenya.world/tags/#ramen" title="Pages tagged ramen" class="tag"><span class="term">ramen</span></a><a href="http://ramenya.world/tags/#code" title="Pages tagged code" class="tag"><span class="term">code</span></a><a href="http://ramenya.world/tags/#smart%20contract" title="Pages tagged smart contract" class="tag"><span class="term">smart contract</span></a><a href="http://ramenya.world/tags/#solidity" title="Pages tagged solidity" class="tag"><span class="term">solidity</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://ramenya.world/smart-contracts/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=http://ramenya.world/smart-contracts/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=http://ramenya.world/smart-contracts/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> </header> <!-- JS --> <script src="http://ramenya.world/assets/js/jquery-1.12.0.min.js"></script> <script src="http://ramenya.world/assets/js/jquery.dlmenu.min.js"></script> <script src="http://ramenya.world/assets/js/jquery.goup.min.js"></script> <script src="http://ramenya.world/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://ramenya.world/assets/js/jquery.fitvid.min.js"></script> <script src="http://ramenya.world/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'awasunyin'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
